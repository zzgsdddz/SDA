---
title: "SDA Group Submission Assignment Assign4"
subtitle: "Group Gr18" 
author: "MengliFeng (2720589) and PepijnVanOostveen (2801582)"
output: 
  pdf_document:
    keep_tex: true
header-includes:
  - \usepackage{fvextra}
  - \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
---

# Exercise 1
```{r}
library(carData)
Davis <- Davis[-12, ]
head(Davis)
```
## a.
```{r}
# Load necessary libraries
library(ggplot2)

# Split data by sex
Davis_M <- subset(Davis, sex == "M")
Davis_F <- subset(Davis, sex == "F")

# Set up plotting area
par(mfrow = c(2, 2))

# Histograms for height distributions (scaled to density)
hist(Davis_M$height, probability = TRUE, main = "Height Distribution (Males)", xlab = "Height (cm)", col = "blue")
hist(Davis_F$height, probability = TRUE, main = "Height Distribution (Females)", xlab = "Height (cm)", col = "red")

# QQ-plots for normality check
qqnorm(Davis_M$height, main = "QQ-Plot (Males)")
qqline(Davis_M$height)

qqnorm(Davis_F$height, main = "QQ-Plot (Females)")
qqline(Davis_F$height)

# Normality test using Shapiro-Wilk
shapiro.test(Davis_M$height)
shapiro.test(Davis_F$height)
```
from both the histograms and the qq-plots, we can see the distributions of heights of both male and female are both close to normal distribution. From the histograms, we can observe a subtlety that heights of males have more mass below the mean and vice versa for weights of females.

From Shapiro-Wilk test results, the null hypothesis is not rejected.

? what's about the rounded heights

## b.
```{r}
# Set seed for reproducibility
set.seed(1234)

# Function to compute the difference in means
mean_diff <- function(data) {
  mean(data$height[data$sex == "M"]) - mean(data$height[data$sex == "F"])
}

# **Empirical Bootstrap**
n_bootstrap <- 1000  # Number of bootstrap samples
boot_diffs_empirical <- replicate(n_bootstrap, {
  resample_M <- sample(Davis_M$height, replace = TRUE)
  resample_F <- sample(Davis_F$height, replace = TRUE)
  mean(resample_M) - mean(resample_F)
})

# Standard deviation of bootstrap samples (empirical bootstrap)
sd_empirical <- sd(boot_diffs_empirical)

# **Parametric Bootstrap (assuming normality)**
parametric_boot_diffs <- replicate(n_bootstrap, {
  resample_M <- rnorm(length(Davis_M$height), mean(Davis_M$height), sd(Davis_M$height))
  resample_F <- rnorm(length(Davis_F$height), mean(Davis_F$height), sd(Davis_F$height))
  mean(resample_M) - mean(resample_F)
})

# Standard deviation of bootstrap samples (parametric bootstrap)
sd_parametric <- sd(parametric_boot_diffs)

# Print results
cat("Empirical Bootstrap SD:", sd_empirical, "\n")
cat("Parametric Bootstrap SD:", sd_parametric, "\n")
```

## c.
```{r}
# Given values
mu_M <- 177.8
mu_F <- 164.6
sigma_M <- 6.5
sigma_F <- 5.5
n_M <- length(Davis_M$height)
n_F <- length(Davis_F$height)

# Compute theoretical standard deviation
theoretical_sd <- sqrt((sigma_M^2 / n_M) + (sigma_F^2 / n_F))
cat("Theoretical SD:", theoretical_sd, "\n")

# Compare theoretical vs. bootstrap estimates
comparison <- data.frame(
  Method = c("Empirical Bootstrap", "Parametric Bootstrap", "Theoretical"),
  SD = c(sd_empirical, sd_parametric, theoretical_sd)
)

print(comparison)
```
the parametric boostrap estimation of the sd of the mean difference is closer to the theoretical value

## d.
```{r}
# Set boundaries for uniform distribution
min_M <- min(Davis_M$height)
max_M <- max(Davis_M$height)
min_F <- min(Davis_F$height)
max_F <- max(Davis_F$height)

# Perform parametric bootstrap with uniform distribution
uniform_boot_diffs <- replicate(n_bootstrap, {
  resample_M <- runif(n_M, min_M, max_M)
  resample_F <- runif(n_F, min_F, max_F)
  mean(resample_M) - mean(resample_F)
})

# Standard deviation of bootstrap samples (uniform distribution)
sd_uniform <- sd(uniform_boot_diffs)

cat("Uniform Bootstrap SD:", sd_uniform, "\n")

# Compare with theoretical standard deviation
comparison <- rbind(comparison, c("Uniform Bootstrap", sd_uniform))
print(comparison)
```


# Exercise 2
## a.

## b.

## c.

