---
title: "SDA Group Submission Assignment Assign1"
subtitle: "Group Gr18" 
author: "MengliFeng (2720589) and PepijnVanOostveen (2801582)"
output: 
  pdf_document:
    keep_tex: true
header-includes:
  - \usepackage{fvextra}
  - \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
---

# Exercise 1
## a.
```{r}
# Step 1: Create the contingency matrix
email_matrix <- matrix(c(9, 11, 4, 21), nrow = 2, byrow = FALSE,
                       dimnames = list(Spam_Status = c("Spam", "Not_Spam"),
                                       Urgency = c("Urgent", "Not_Urgent")))

# Step 2: Mosaic plot with custom colors
mosaicplot(email_matrix, color = c("tomato", "lightblue"), 
           main = "Mosaic Plot of Email Spam by Urgency",
           xlab = "Urgency", ylab = "Spam Status", 
           sort = 1:2, dir = c("h", "v"))
```


## b.
P(Spam|Urgent) = 9/(9+4) = 0.692
this is computed by diving the number of spam labeled urgent and the total emails that are labeled as urgent.

## c.
```{r}
# Extract values
a <- email_matrix["Spam", "Urgent"]
b <- email_matrix["Not_Spam", "Urgent"]
c <- email_matrix["Spam", "Not_Urgent"]
d <- email_matrix["Not_Spam", "Not_Urgent"]

# Compute conditional probabilities
odds_ratio <- (a / b) / (c / d)
odds_ratio
```
## d.
```{r}
# Perform one-sided Fisher's exact test
fisher_result <- fisher.test(email_matrix, alternative = "greater")
fisher_result
```
since we want to know if urgent means more likely spam (not just related), we use one-sided test, with alternative odds is greater than 1 (urgent emails have higher odds being spam).
the null is rejected

# Exercise 2
## a.
```{r}
# Create the table and then use it to make a mosaicplot
titanic_CS <- margin.table(Titanic, margin = c(1, 4))
mosaicplot(titanic_CS, main = "Titanic Survival by Class", color = c("red", "darkgreen"))

```
There is an obvious correlation between the class and chance of survival. So the wealthier you were (or more accurately the more you spent on your ticket) the likelier you were to survive with the crew being the least likely to survive.


## b.
```{r}
# Do the test
chisq.test(titanic_CS)

```
The p-value is less than 10^-15 it is far smaller than the significance level of 0.05 and thus the null is rejected as we expected. This means that the test had the same result as we had by just looking at the mosaic namely that there is a relationship between the class and the chance to survive.

## c.
```{r}
# Get the expected values
test_result <- chisq.test(titanic_CS)
test_result$expected

# The real values
titanic_CS
```
The values that are the farthest apart from the expected values is the survival chance of 1st class, but I expected that so the thing that I found most striking is that there is almost no difference between 3rd class and the crew. I thought that knowing more about the ship would help the crew and that 3rd class had the lowest chances since 1st and 2nd class were situated better.

## d.
```{r}
# get the 3rd and crew rows from our table
third_crew <- titanic_CS[c("3rd", "Crew"), ]

# make it a matrix and then test as alternative greater since the first row is 3rd class and we want to know if first class has a better survival chance
survival_table <- as.matrix(third_crew)
fisher.test(survival_table, alternative = "greater")

```
The p-value is 0.7385 so the survival chance isn't significantly higher for 3rd class and thus the hypothesis that the chacnes are equal isn't rejected.
