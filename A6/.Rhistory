# Step 1: Create the contingency matrix
email_matrix <- matrix(c(9, 11, 4, 21), nrow = 2, byrow = FALSE,
dimnames = list(Spam_Status = c("Spam", "Not_Spam"),
Urgency = c("Urgent", "Not_Urgent")))
# Step 2: Mosaic plot with custom colors
mosaicplot(email_matrix, color = c("tomato", "lightblue"),
main = "Mosaic Plot of Email Spam by Urgency",
xlab = "Urgency", ylab = "Spam Status",
sort = 1:2, dir = c("h", "v"))
# Extract values
a <- email_matrix["Spam", "Urgent"]
b <- email_matrix["Not_Spam", "Urgent"]
c <- email_matrix["Spam", "Not_Urgent"]
d <- email_matrix["Not_Spam", "Not_Urgent"]
# Compute conditional probabilities
odds_ratio <- (a / b) / (c / d)
odds_ratio
# Perform one-sided Fisher's exact test
fisher_result <- fisher.test(email_matrix, alternative = "greater")
fisher_result
